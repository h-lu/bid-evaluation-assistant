# AI Agent 变更管理规范

> 版本：v2026.02.21-r3  
> 状态：Active  
> 适用范围：Prompt、策略、工具契约、模型路由、门禁阈值、工作流

## 1. 目标

1. 每次变更可评审、可验证、可回滚。
2. 避免“改一点上线一点”的无门禁发布。
3. 建立与质量/安全/成本门禁的联动。

## 2. 变更分级

### C1（低风险）

1. 文案优化、注释修订、无行为变化配置。
2. 审批：模块负责人。

### C2（中风险）

1. Prompt 策略调整。
2. 检索参数与阈值调整。
3. 非高风险工具 schema 变更。
4. 审批：模块负责人 + 测试负责人。

### C3（高风险）

1. 权限边界变更。
2. 高风险工具调用路径变更。
3. HITL/门禁阈值变更。
4. 外部系统写操作新增。
5. 审批：技术负责人 + 安全负责人 + 业务负责人。

## 3. 变更流程

```text
提案 -> 影响分析 -> 审批 -> 预发验证 -> 灰度发布 -> 全量发布 -> 复盘归档
```

每步必须留痕：

1. `change_id`
2. `owner`
3. `risk_level`
4. `scope`
5. `verification_evidence`
6. `rollback_plan`

## 4. 提案模板（最小）

1. 背景与目标。
2. 影响范围（模块/租户/接口/任务类型）。
3. 风险评估（质量/性能/安全/成本）。
4. 验证计划（离线/预发/灰度）。
5. 回滚计划（触发条件、执行步骤、责任人）。

## 5. 发布门禁

### 5.1 通用门禁

1. 核心测试通过。
2. 离线评估达标。
3. 预发回放无阻断劣化。
4. 安全回归通过。
5. 成本评估通过。

### 5.2 C3 附加门禁

1. 双人复核签字。
2. 灰度期加严告警。
3. 回滚演练通过。

## 6. 回滚治理

1. 回滚触发条件在变更提案中预先定义。
2. 回滚后 24h 内必须补充复盘。
3. 同类问题重复出现需升级治理项。

## 7. Agent 开发协作要求

1. 并行子任务合并前必须做契约一致性检查。
2. 任何变更不能绕过 SSOT。
3. 变更结论必须有客观证据，不接受口头“应该没问题”。

## 8. 验收标准

1. 任意变更都可追溯完整链路。
2. 高风险变更无审批不可发布。
3. 回滚流程可在演练中复现。

## 9. 关联文档

1. `docs/design/2026-02-21-agent-development-lifecycle.md`
2. `docs/design/2026-02-21-agent-evals-observability.md`
3. `docs/ops/agent-incident-runbook.md`
